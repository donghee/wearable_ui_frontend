import numpy as np
from math import sin, cos, radians, degrees, asin, pi


def ff_func(X):
    global L_hw, L_ht, L_hs, L_rw, L_rt, L_rs, L_rtw, L_rts
    global l_w, l_t, l_s, q_s, q_rh, q_rk, q_hh, q_hk
    global m_hw, m_ht, m_hs, m_rw, m_rt, m_rs
    global G_hw, G_ht, G_hs, G_rw, G_rt, G_rs
    global K_w, K_t, K_s, K_tw, K_tt, K_ts 
    global l_w_0, l_t_0, l_s_0 

    q_w = X[0]
    q_t = X[1]

    # matlab
    # f1 = conj(K_tw)*conj(q_w) + conj(g)*conj(m_rs)*(conj(G_rs)*((cos(conj(q_w))*conj(L_rw)*sin((5*pi)/2 - conj(q_hh)))/sin(conj(q_hh)) - (cos(conj(q_w))*sin((3*pi)/2 - conj(q_hh) + conj(q_hk))*conj(L_rw)*cos(conj(q_hk) - conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))))/(sin(conj(q_hh))*conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)))) + (cos(conj(q_w))*conj(L_rw)*sin((5*pi)/2 - conj(q_hh)))/sin(conj(q_hh))) + conj(G_rw)*conj(g)*conj(m_rw)*(cos((3*pi)/2 + conj(q_w))*conj(L_rw) + (2*cos(conj(q_hh) + conj(q_w))*conj(L_rw))/sin(conj(q_hh))) - (cos(conj(q_w))*conj(K_t)*conj(L_rw)*(conj(l_t_0) - (sin(conj(q_w))*conj(L_rw) + sin(conj(q_hh) + conj(q_t))*conj(L_rtw))/sin(conj(q_hh))))/sin(conj(q_hh)) + (cos(conj(q_hh) + conj(q_w))*conj(K_w)*conj(L_rw)*(conj(l_w_0) + (sin(conj(q_t))*conj(L_rtw) - sin(conj(q_hh))*conj(L_hw) + sin(conj(q_hh) + conj(q_w))*conj(L_rw))/sin(conj(q_hh))))/sin(conj(q_hh)) + (cos(conj(q_w))*conj(G_ht)*conj(L_rw)*sin((5*pi)/2 - conj(q_hh))*conj(g)*conj(m_ht))/sin(conj(q_hh)) + (2*cos(conj(q_w))*conj(G_rt)*conj(L_rw)*sin((5*pi)/2 - conj(q_hh))*conj(g)*conj(m_rt))/sin(conj(q_hh)) - (cos(conj(q_w))*conj(K_s)*conj(L_rw)*cos(conj(q_hk) - conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*(conj(l_s_0) + (sin(conj(q_hk) - conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*conj(L_rs) - sin(conj(q_hk))*conj(L_hs) + sin(conj(q_t))*conj(L_rts))/sin(conj(q_hk))))/(sin(conj(q_hh))*conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2))) + (cos(conj(q_w))*sin(conj(q_hk))*conj(K_ts)*conj(L_rw)*conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/(sin(conj(q_hh))*conj(L_rs)*conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)));
    # f2 = conj(K_tt)*conj(q_t) + conj(g)*conj(m_rs)*(conj(G_rs)*((sin((3*pi)/2 - conj(q_hh) + conj(q_hk))*(cos(conj(q_t))*conj(L_rts) - (cos(conj(q_hk) - conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*(cos(conj(q_hk) + conj(q_t))*conj(L_rts) + (sin(conj(q_hk))*cos(conj(q_hh) + conj(q_t))*conj(L_rtw))/sin(conj(q_hh))))/conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2))))/sin(conj(q_hk)) - cos(conj(q_hh) - (5*pi)/2 + conj(q_t))*conj(L_rts) + (cos(conj(q_hh) + conj(q_t))*conj(L_rtw)*sin((5*pi)/2 - conj(q_hh)))/sin(conj(q_hh))) - cos(conj(q_hh) - (5*pi)/2 + conj(q_t))*conj(L_rts) + (cos(conj(q_hh) + conj(q_t))*conj(L_rtw)*sin((5*pi)/2 - conj(q_hh)))/sin(conj(q_hh))) - conj(G_rt)*conj(g)*conj(m_rt)*(cos(conj(q_hh) - (5*pi)/2 + conj(q_t))*conj(L_rts) + cos(conj(q_hh) - (3*pi)/2 + conj(q_t))*conj(L_rtw) - (2*cos(conj(q_hh) + conj(q_t))*conj(L_rtw)*sin((5*pi)/2 - conj(q_hh)))/sin(conj(q_hh))) + (conj(K_s)*(conj(l_s_0) + (sin(conj(q_hk) - conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*conj(L_rs) - sin(conj(q_hk))*conj(L_hs) + sin(conj(q_t))*conj(L_rts))/sin(conj(q_hk)))*(cos(conj(q_t))*conj(L_rts) - (cos(conj(q_hk) - conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*(cos(conj(q_hk) + conj(q_t))*conj(L_rts) + (sin(conj(q_hk))*cos(conj(q_hh) + conj(q_t))*conj(L_rtw))/sin(conj(q_hh))))/conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2))))/sin(conj(q_hk)) - (cos(conj(q_hh) + conj(q_t))*conj(K_t)*conj(L_rtw)*(conj(l_t_0) - (sin(conj(q_w))*conj(L_rw) + sin(conj(q_hh) + conj(q_t))*conj(L_rtw))/sin(conj(q_hh))))/sin(conj(q_hh)) + (cos(conj(q_t))*conj(K_w)*conj(L_rtw)*(conj(l_w_0) + (sin(conj(q_t))*conj(L_rtw) - sin(conj(q_hh))*conj(L_hw) + sin(conj(q_hh) + conj(q_w))*conj(L_rw))/sin(conj(q_hh))))/sin(conj(q_hh)) + (conj(K_ts)*conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(cos(conj(q_hk) + conj(q_t))*conj(L_rts) + (sin(conj(q_hk))*cos(conj(q_hh) + conj(q_t))*conj(L_rtw))/sin(conj(q_hh))))/(conj(L_rs)*conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2))) + (2*cos(conj(q_t))*conj(G_rw)*conj(L_rtw)*conj(g)*conj(m_rw))/sin(conj(q_hh)) + (cos(conj(q_hh) + conj(q_t))*conj(G_ht)*conj(L_rtw)*sin((5*pi)/2 - conj(q_hh))*conj(g)*conj(m_ht))/sin(conj(q_hh));

    f1 = np.conj(K_tw)*np.conj(q_w) + np.conj(g)*np.conj(m_rs)*(np.conj(G_rs)*((cos(np.conj(q_w))*np.conj(L_rw)*sin((5*pi)/2 - np.conj(q_hh)))/sin(np.conj(q_hh)) - (cos(np.conj(q_w))*sin((3*pi)/2 - np.conj(q_hh) + np.conj(q_hk))*np.conj(L_rw)*cos(np.conj(q_hk) - np.conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))))/(sin(np.conj(q_hh))*np.conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)))) + (cos(np.conj(q_w))*np.conj(L_rw)*sin((5*pi)/2 - np.conj(q_hh)))/sin(np.conj(q_hh))) + np.conj(G_rw)*np.conj(g)*np.conj(m_rw)*(cos((3*pi)/2 + np.conj(q_w))*np.conj(L_rw) + (2*cos(np.conj(q_hh) + np.conj(q_w))*np.conj(L_rw))/sin(np.conj(q_hh))) - (cos(np.conj(q_w))*np.conj(K_t)*np.conj(L_rw)*(np.conj(l_t_0) - (sin(np.conj(q_w))*np.conj(L_rw) + sin(np.conj(q_hh) + np.conj(q_t))*np.conj(L_rtw))/sin(np.conj(q_hh))))/sin(np.conj(q_hh)) + (cos(np.conj(q_hh) + np.conj(q_w))*np.conj(K_w)*np.conj(L_rw)*(np.conj(l_w_0) + (sin(np.conj(q_t))*np.conj(L_rtw) - sin(np.conj(q_hh))*np.conj(L_hw) + sin(np.conj(q_hh) + np.conj(q_w))*np.conj(L_rw))/sin(np.conj(q_hh))))/sin(np.conj(q_hh)) + (cos(np.conj(q_w))*np.conj(G_ht)*np.conj(L_rw)*sin((5*pi)/2 - np.conj(q_hh))*np.conj(g)*np.conj(m_ht))/sin(np.conj(q_hh)) + (2*cos(np.conj(q_w))*np.conj(G_rt)*np.conj(L_rw)*sin((5*pi)/2 - np.conj(q_hh))*np.conj(g)*np.conj(m_rt))/sin(np.conj(q_hh)) - (cos(np.conj(q_w))*np.conj(K_s)*np.conj(L_rw)*cos(np.conj(q_hk) - np.conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*(np.conj(l_s_0) + (sin(np.conj(q_hk) - np.conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*np.conj(L_rs) - sin(np.conj(q_hk))*np.conj(L_hs) + sin(np.conj(q_t))*np.conj(L_rts))/sin(np.conj(q_hk))))/(sin(np.conj(q_hh))*np.conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2))) + (cos(np.conj(q_w))*sin(np.conj(q_hk))*np.conj(K_ts)*np.conj(L_rw)*np.conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/(sin(np.conj(q_hh))*np.conj(L_rs)*np.conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)))
    f2 = np.conj(K_tt)*np.conj(q_t) + np.conj(g)*np.conj(m_rs)*(np.conj(G_rs)*((sin((3*pi)/2 - np.conj(q_hh) + np.conj(q_hk))*(cos(np.conj(q_t))*np.conj(L_rts) - (cos(np.conj(q_hk) - np.conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*(cos(np.conj(q_hk) + np.conj(q_t))*np.conj(L_rts) + (sin(np.conj(q_hk))*cos(np.conj(q_hh) + np.conj(q_t))*np.conj(L_rtw))/sin(np.conj(q_hh))))/np.conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2))))/sin(np.conj(q_hk)) - cos(np.conj(q_hh) - (5*pi)/2 + np.conj(q_t))*np.conj(L_rts) + (cos(np.conj(q_hh) + np.conj(q_t))*np.conj(L_rtw)*sin((5*pi)/2 - np.conj(q_hh)))/sin(np.conj(q_hh))) - cos(np.conj(q_hh) - (5*pi)/2 + np.conj(q_t))*np.conj(L_rts) + (cos(np.conj(q_hh) + np.conj(q_t))*np.conj(L_rtw)*sin((5*pi)/2 - np.conj(q_hh)))/sin(np.conj(q_hh))) - np.conj(G_rt)*np.conj(g)*np.conj(m_rt)*(cos(np.conj(q_hh) - (5*pi)/2 + np.conj(q_t))*np.conj(L_rts) + cos(np.conj(q_hh) - (3*pi)/2 + np.conj(q_t))*np.conj(L_rtw) - (2*cos(np.conj(q_hh) + np.conj(q_t))*np.conj(L_rtw)*sin((5*pi)/2 - np.conj(q_hh)))/sin(np.conj(q_hh))) + (np.conj(K_s)*(np.conj(l_s_0) + (sin(np.conj(q_hk) - np.conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*np.conj(L_rs) - sin(np.conj(q_hk))*np.conj(L_hs) + sin(np.conj(q_t))*np.conj(L_rts))/sin(np.conj(q_hk)))*(cos(np.conj(q_t))*np.conj(L_rts) - (cos(np.conj(q_hk) - np.conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))*(cos(np.conj(q_hk) + np.conj(q_t))*np.conj(L_rts) + (sin(np.conj(q_hk))*cos(np.conj(q_hh) + np.conj(q_t))*np.conj(L_rtw))/sin(np.conj(q_hh))))/np.conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2))))/sin(np.conj(q_hk)) - (cos(np.conj(q_hh) + np.conj(q_t))*np.conj(K_t)*np.conj(L_rtw)*(np.conj(l_t_0) - (sin(np.conj(q_w))*np.conj(L_rw) + sin(np.conj(q_hh) + np.conj(q_t))*np.conj(L_rtw))/sin(np.conj(q_hh))))/sin(np.conj(q_hh)) + (cos(np.conj(q_t))*np.conj(K_w)*np.conj(L_rtw)*(np.conj(l_w_0) + (sin(np.conj(q_t))*np.conj(L_rtw) - sin(np.conj(q_hh))*np.conj(L_hw) + sin(np.conj(q_hh) + np.conj(q_w))*np.conj(L_rw))/sin(np.conj(q_hh))))/sin(np.conj(q_hh)) + (np.conj(K_ts)*np.conj(asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(cos(np.conj(q_hk) + np.conj(q_t))*np.conj(L_rts) + (sin(np.conj(q_hk))*cos(np.conj(q_hh) + np.conj(q_t))*np.conj(L_rtw))/sin(np.conj(q_hh))))/(np.conj(L_rs)*np.conj((1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2))) + (2*cos(np.conj(q_t))*np.conj(G_rw)*np.conj(L_rtw)*np.conj(g)*np.conj(m_rw))/sin(np.conj(q_hh)) + (cos(np.conj(q_hh) + np.conj(q_t))*np.conj(G_ht)*np.conj(L_rtw)*sin((5*pi)/2 - np.conj(q_hh))*np.conj(g)*np.conj(m_ht))/sin(np.conj(q_hh))

    F = [f1, f2]
    #print(F)
    return np.array(F)


def jj_func(X):
    global L_hw, L_ht, L_hs, L_rw, L_rt, L_rs, L_rtw, L_rts
    global l_w, l_t, l_s, q_s, q_rh, q_rk, q_hh, q_hk
    global m_hw, m_ht, m_hs, m_rw, m_rt, m_rs
    global G_hw, G_ht, G_hs, G_rw, G_rt, G_rs
    global K_w, K_t, K_s, K_tw, K_tt, K_ts 
    global l_w_0, l_t_0, l_s_0 

    q_w = X[0]
    q_t = X[1]

    # matlab
    # j11 = K_tw + g*m_rs*(G_rs*((L_rw*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) + (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*sin(q_w))/(sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (L_rw^2*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)^2*sin(q_hk))/(L_rs*sin(q_hh)^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (L_rw^2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)^2*sin(q_hk)*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))) + (L_rw*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh)) - G_rw*g*m_rw*(L_rw*sin(q_w + (3*pi)/2) + (2*L_rw*sin(q_hh + q_w))/sin(q_hh)) + (K_w*L_rw^2*cos(q_hh + q_w)^2)/sin(q_hh)^2 + (K_t*L_rw^2*cos(q_w)^2)/sin(q_hh)^2 - (K_w*L_rw*sin(q_hh + q_w)*(l_w_0 + (L_rw*sin(q_hh + q_w) - L_hw*sin(q_hh) + L_rtw*sin(q_t))/sin(q_hh)))/sin(q_hh) + (K_t*L_rw*sin(q_w)*(l_t_0 - (L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w))/sin(q_hh)))/sin(q_hh) - (K_s*L_rw^2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))^2*cos(q_w)^2)/(sin(q_hh)^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_ts*L_rw^2*cos(q_w)^2*sin(q_hk)^2)/(L_rs^2*sin(q_hh)^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) + (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_w)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (G_ht*L_rw*g*m_ht*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) + (2*G_rt*L_rw*g*m_rt*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) - (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*sin(q_hk)*sin(q_w))/(L_rs*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (K_s*L_rw^2*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)^2*sin(q_hk)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(L_rs*sin(q_hh)^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) + (K_ts*L_rw^2*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)^2*sin(q_hk)^2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^3*sin(q_hh)^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2)) - (K_s*L_rw^2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)^2*sin(q_hk)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2));
    # j12 = G_rs*g*m_rs*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))) + (K_t*L_rw*L_rtw*cos(q_hh + q_t)*cos(q_w))/sin(q_hh)^2 + (K_w*L_rw*L_rtw*cos(q_hh + q_w)*cos(q_t))/sin(q_hh)^2 - (K_ts*L_rw*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs^2*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)))/(sin(q_hh)*sin(q_hk)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (K_s*L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2)) + (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^3*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2));
    # j21 = (K_s*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2)))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/sin(q_hk) + (K_t*L_rw*L_rtw*cos(q_hh + q_t)*cos(q_w))/sin(q_hh)^2 + (K_w*L_rw*L_rtw*cos(q_hh + q_w)*cos(q_t))/sin(q_hh)^2 + (G_rs*g*m_rs*sin(q_hk - q_hh + (3*pi)/2)*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))))/sin(q_hk) - (K_ts*L_rw*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs^2*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)))/(sin(q_hh)*sin(q_hk)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^3*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2));
    # j22 = K_tt + (K_s*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2))^2)/sin(q_hk)^2 + g*m_rs*(L_rts*sin(q_hh + q_t - (5*pi)/2) + G_rs*(L_rts*sin(q_hh + q_t - (5*pi)/2) - (sin(q_hk - q_hh + (3*pi)/2)*(L_rts*sin(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2) - (sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2)/(L_rs*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) + (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))))/sin(q_hk) + (L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) + (L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) - (K_ts*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2)/(L_rs^2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) - (K_s*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2) - (sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2)/(L_rs*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2 - 1)) + (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2))))/sin(q_hk) + G_rt*g*m_rt*(L_rts*sin(q_hh + q_t - (5*pi)/2) + L_rtw*sin(q_hh + q_t - (3*pi)/2) + (2*L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) + (K_t*L_rtw^2*cos(q_hh + q_t)^2)/sin(q_hh)^2 + (K_w*L_rtw^2*cos(q_t)^2)/sin(q_hh)^2 - (K_w*L_rtw*sin(q_t)*(l_w_0 + (L_rw*sin(q_hh + q_w) - L_hw*sin(q_hh) + L_rtw*sin(q_t))/sin(q_hh)))/sin(q_hh) - (K_ts*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(1/2)) + (K_t*L_rtw*sin(q_hh + q_t)*(l_t_0 - (L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w))/sin(q_hh)))/sin(q_hh) - (2*G_rw*L_rtw*g*m_rw*sin(q_t))/sin(q_hh) + (K_ts*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))^2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs^3*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))^2/L_rs^2)^(3/2)) + (G_ht*L_rtw*g*m_ht*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh);

    j11 = K_tw + g*m_rs*(G_rs*((L_rw*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) + (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*sin(q_w))/(sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)) + (L_rw**2*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)**2*sin(q_hk))/(L_rs*sin(q_hh)**2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (L_rw**2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)**2*sin(q_hk)*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**2*sin(q_hh)**2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2))) + (L_rw*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh)) - G_rw*g*m_rw*(L_rw*sin(q_w + (3*pi)/2) + (2*L_rw*sin(q_hh + q_w))/sin(q_hh)) + (K_w*L_rw**2*cos(q_hh + q_w)**2)/sin(q_hh)**2 + (K_t*L_rw**2*cos(q_w)**2)/sin(q_hh)**2 - (K_w*L_rw*sin(q_hh + q_w)*(l_w_0 + (L_rw*sin(q_hh + q_w) - L_hw*sin(q_hh) + L_rtw*sin(q_t))/sin(q_hh)))/sin(q_hh) + (K_t*L_rw*sin(q_w)*(l_t_0 - (L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w))/sin(q_hh)))/sin(q_hh) - (K_s*L_rw**2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))**2*cos(q_w)**2)/(sin(q_hh)**2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (K_ts*L_rw**2*cos(q_w)**2*sin(q_hk)**2)/(L_rs**2*sin(q_hh)**2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) + (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_w)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)) + (G_ht*L_rw*g*m_ht*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) + (2*G_rt*L_rw*g*m_rt*sin(q_w)*sin(q_hh - (5*pi)/2))/sin(q_hh) - (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*sin(q_hk)*sin(q_w))/(L_rs*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)) + (K_s*L_rw**2*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)**2*sin(q_hk)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(L_rs*sin(q_hh)**2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) + (K_ts*L_rw**2*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)**2*sin(q_hk)**2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**3*sin(q_hh)**2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2)) - (K_s*L_rw**2*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)**2*sin(q_hk)*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**2*sin(q_hh)**2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2))
    j12 = G_rs*g*m_rs*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*sin(q_hk - q_hh + (3*pi)/2)*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2))) + (K_t*L_rw*L_rtw*cos(q_hh + q_t)*cos(q_w))/sin(q_hh)**2 + (K_w*L_rw*L_rtw*cos(q_hh + q_w)*cos(q_t))/sin(q_hh)**2 - (K_ts*L_rw*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs**2*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)))/(sin(q_hh)*sin(q_hk)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)) + (K_s*L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2)) + (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**3*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2))
    j21 = (K_s*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2)))*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk)))/sin(q_hk) + (K_t*L_rw*L_rtw*cos(q_hh + q_t)*cos(q_w))/sin(q_hh)**2 + (K_w*L_rw*L_rtw*cos(q_hh + q_w)*cos(q_t))/sin(q_hh)**2 + (G_rs*g*m_rs*sin(q_hk - q_hh + (3*pi)/2)*((L_rw*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**2*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2))))/sin(q_hk) - (K_ts*L_rw*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs**2*sin(q_hh)*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (K_s*L_rw*cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*cos(q_w)*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)))/(sin(q_hh)*sin(q_hk)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)) + (K_ts*L_rw*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*cos(q_w)*sin(q_hk)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**3*sin(q_hh)*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2))
    j22 = K_tt + (K_s*(L_rts*cos(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2))**2)/sin(q_hk)**2 + g*m_rs*(L_rts*sin(q_hh + q_t - (5*pi)/2) + G_rs*(L_rts*sin(q_hh + q_t - (5*pi)/2) - (sin(q_hk - q_hh + (3*pi)/2)*(L_rts*sin(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2) - (sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))**2)/(L_rs*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) + (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))**2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2))))/sin(q_hk) + (L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) + (L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) - (K_ts*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))**2)/(L_rs**2*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) - (K_s*(l_s_0 + (L_rts*sin(q_t) - L_hs*sin(q_hk) + L_rs*sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)))/sin(q_hk))*(L_rts*sin(q_t) - (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2) - (sin(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))**2)/(L_rs*((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2 - 1)) + (cos(q_hk - asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs))*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))**2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**2*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2))))/sin(q_hk) + G_rt*g*m_rt*(L_rts*sin(q_hh + q_t - (5*pi)/2) + L_rtw*sin(q_hh + q_t - (3*pi)/2) + (2*L_rtw*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)) + (K_t*L_rtw**2*cos(q_hh + q_t)**2)/sin(q_hh)**2 + (K_w*L_rtw**2*cos(q_t)**2)/sin(q_hh)**2 - (K_w*L_rtw*sin(q_t)*(l_w_0 + (L_rw*sin(q_hh + q_w) - L_hw*sin(q_hh) + L_rtw*sin(q_t))/sin(q_hh)))/sin(q_hh) - (K_ts*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*(L_rts*sin(q_hk + q_t) + (L_rtw*sin(q_hh + q_t)*sin(q_hk))/sin(q_hh)))/(L_rs*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(1/2)) + (K_t*L_rtw*sin(q_hh + q_t)*(l_t_0 - (L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w))/sin(q_hh)))/sin(q_hh) - (2*G_rw*L_rtw*g*m_rw*sin(q_t))/sin(q_hh) + (K_ts*asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)*(L_rts*cos(q_hk + q_t) + (L_rtw*cos(q_hh + q_t)*sin(q_hk))/sin(q_hh))**2*(L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh)))/(L_rs**3*(1 - (L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))**2/L_rs**2)**(3/2)) + (G_ht*L_rtw*g*m_ht*sin(q_hh + q_t)*sin(q_hh - (5*pi)/2))/sin(q_hh)

    J = [[j11, j12], [j21, j22]]
    #print(J)
    return np.array(J)


# INPUT

interval = 1 #[deg]

minimum_hip_angle = 30 #[deg] ex) 0 45 90 180
maximum_hip_angle = 330 #[deg] 

minimum_knee_angle = 30 #[deg] ex) 0 45 90 180
maximum_knee_angle = 180 #[deg] 

# 

H = np.arange(minimum_hip_angle, maximum_hip_angle + interval, interval) # human hip angle
NH = np.where(H == 180)[0] # singularity
H = np.delete(H, NH) # delite 180deg

K = np.arange(minimum_knee_angle, maximum_knee_angle + interval, interval) # human knee angle
NK = np.where(K == 180)[0] # singularity
K = np.delete(K, NK) # delite 180deg


# constant value 73kg, 1741mm, male

L_hw = 0.1457 # human waist length[m]
L_ht = 0.4222 # human thigh length[m]
L_hs = 0.4340 # human shank length[m]
L_rw = 0.1 # robot waist length[m]
L_rt = 0.4222 # robot thigh length[m]
L_rs = 0.35 # robot shank length[m]
L_rtw = 0.2111 # robot thigh-waist length[m]
L_rts = 0.2111 # robot thigh-shank length[m]

m_hw = 8.1541 # human waist weight[kg]
m_ht = 10.3368 # human thigh weight[kg]
m_hs = 3.7518 # human shank weight[kg]
m_rw = 5.0000 # robot waist weight[kg]
m_rt = 4.2220 # robot thigh weight[kg]
m_rs = 3.5000 # robot waist weight[kg]

G_hw = 0.3885 # human waist gravity ratio
G_ht = 0.4095 # human thigh gravity ratio
G_hs = 0.4459 # human shank gravity ratio
G_rw = 0.5 # robot waist gravity ratio
G_rt = 0.5 # robot thigh gravity ratio
G_rs = 0.5 # robot shank gravity ratio

K_w = 10000 # human waist shear stiffness[N/m]
K_t = 10000 # human thigh shear stiffness[N/m]
K_s = 5000 # human shank shear stiffness[N/m]
K_tw = 5000 # human waist torsion stiffness[N/m]
K_tt = 5000 # human thigh torsion stiffness[N/m]
K_ts = 5000 # human shank torsion stiffness[N/m]

g = 9.81 # gravitational acceleration[m/s^2]


# initial value of spring length

l_w_0 = L_hw - L_rw # initial value of human waist spring[m] 
l_t_0 = L_rtw # initial value of human thigh spring[m] 
l_s_0 = L_hs - L_rs # initial value of human shank spring[m] 


# Newton-Raphson method 

ID= open("result.txt","w+") # creat result text file 

for n in H:
    X = [radians(0.1), radians(0.1)] # initial value
    
    for m in K:

        q_hh = radians(n) # hip joint angle
        q_hk = radians(m) # knee joint angle
        i = 0
        err = max(np.abs(ff_func(X)))
        tol = 1e-4        
    
        while err > tol:
            i += 1
            X1 = X - np.linalg.inv(jj_func(X)).dot(ff_func(X))
            X = X1
            err = max(np.abs(ff_func(X)))
            print(f'i: {i}, error:{err}')

        q_w, q_t = X
        q_s = -asin((L_rts*sin(q_hk + q_t) - L_ht*sin(q_hk) + (sin(q_hk)*(L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w)))/sin(q_hh))/L_rs)
        l_t = (L_rtw*sin(q_hh + q_t) + L_rw*sin(q_w))/sin(q_hh)
        l_w = -(L_rw*sin(q_hh + q_w) - L_hw*sin(q_hh) + L_rtw*sin(q_t))/sin(q_hh)
        l_s = -(L_rs*sin(q_hk + q_s) - L_hs*sin(q_hk) + L_rts*sin(q_t))/sin(q_hk)
        q_rh = q_s + q_t + q_hh
        q_rk = q_w + q_t + q_hk

        deg_q_hh = round(degrees(q_hh),4)
        deg_q_rh = round(degrees(q_rh),4)
        deg_q_hk = round(degrees(q_hk),4)
        deg_q_rk = round(degrees(q_rk),4)

        deg_q_w = round(degrees(q_w),4)
        deg_q_t = round(degrees(q_t),4)
        deg_q_s = round(degrees(q_s),4)

        mm_def_l_w = round(1000 * (l_w - l_w_0) , 4)
        mm_def_l_t = round(1000 * (l_t - l_t_0) , 4)
        mm_def_l_s = round(1000 * (l_s - l_s_0) , 4)

        ID.write(f'{deg_q_hh} {deg_q_rh} {deg_q_hk} {deg_q_rk} {deg_q_w} {deg_q_t} {deg_q_s} {mm_def_l_w} {mm_def_l_t} {mm_def_l_s}\n')

ID.closed()